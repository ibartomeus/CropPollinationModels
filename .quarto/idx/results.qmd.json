{"title":"Results","markdown":{"yaml":{"title":"Results","format":"html","editor":"visual","editor_options":{"chunk_output_type":"console"}},"headingText":"source the script to read and clean data","containsRefs":false,"markdown":"\n\n```{r load_things, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}\nsource(\"read_data.R\")\nlibrary(lme4)\n```\n\n## How are the main crop visitors?\n\n```{r Fig1, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}\n# run the main models-----\n# analysis: proportion of visits by HB vs WI, or HB, wild bees, and non bees\n\n# fraction of visits by WI boxplot\n\n# calculate fraction of \"visits\" by each group\nfield_data8a$fracWI = field_data8a$wild_insects/field_data8a$all_insects\nfield_data8a$fracHB = field_data8a$honeybee/field_data8a$all_insects\n\n# reorder factor levels of study so they will plot in order of increasing median when we run a boxplot\nfield_data8a$study_id2 <- reorder(field_data8a$study_id2, field_data8a$fracWI, median, na.rm=T)\n\n#png(filename = \"wild insect visits by crop boxplots 11-16-2022.png\", width = 9, height = 5, units = \"in\", bg = \"white\", res = 600)\npar(mar=c(4,4,4,4))\nboxplot(data=field_data8a, fracWI ~ study_id2, col=c(\"light gray\"), xaxt = 'n', xlab=\"study\", ylab=\"proportion of visits by wild insects\", las = 1)\naxis(1,seq(5,90,5))\n#dev.off()\n\n\n\n```\n\n## Which effect has honeybee and wild pollinator visits on yield?\n\n```{r Fig2, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}\n# analysis: mixed models for HB vs WI------\n\n# for this we are using field_data8a, which has HB and WI, and where we have entered manual 0's for HB z-scores in 2 systems where they were =0.\n# note that some of these studies are bees only, and many do not have richness data\n\n# note: the following models will return a warning of \"boundary (singular) fit: see ?isSingular\".  I think this is due to using z-scores, which make the mean of all studies =0, so it should not be a problem for the models.\n\nmod9 = lmer(data=field_data8a, yield_z ~ wild_insects_z*honeybee_z + (1 + wild_insects_z|study_id2) + (1 + honeybee_z|study_id2) + (1 + wild_insects_z*honeybee_z|study_id2), na.action=na.fail, REML=T)\n\nsummary(mod9)\n\n# analysis: mixed models for HB vs WI vs Richness------\n\n# for this we are using field_data9a, which is the subset of studies providing data for HB, WI, and Richness\n\n# I didn't get any convergence warnings when I ran these with the current data, but if it does happen, try adding one of these to the lmer statement:\n# control = lmerControl(optimizer=\"Nelder_Mead\")\n# control = lmerControl(optimizer ='optimx', optCtrl=list(method='L-BFGS-B'))\n\n# note that I'm using 0+ in the random effect instead of 1+ since all studies are z-scored and thus constrained to have a mean of 0. My logic here is that there is no need to try to estimate separate intercepts for each study. We are still estimating the random slopes as usual.\n\nmodR_18 = lmer(data=field_data9a, yield_z ~ wild_insects_z*honeybee_z + wild_insects_z*richness_z + honeybee_z*richness_z + (0 + wild_insects_z*honeybee_z|study_id2) + (0 + wild_insects_z*richness_z|study_id2) +  (0 + honeybee_z*richness_z|study_id2), na.action=na.fail, REML=T)\n\nsummary(modR_18)\n\n# plots: random effect estimates by study, similar to Garibaldi et al 2013 fig 2b, but using model 9 -----\n\na=fixef(mod9)\na_wi = a[2]\t\t#overall slope of wild insects \na_hb = a[3]\t\t#overall slope of honey bee \nb=ranef(mod9)\nqq <- attr(ranef(mod9, condVar = TRUE)[[1]], \"postVar\") # Extract the variances of the random effects\nqq_wi = qq[[1]]\nqq_hb = qq[[2]]\ne_wi=(sqrt(qq_wi))\t\ne_wi=e_wi[2,2,]\t\t\ne_hb=(sqrt(qq_hb))\t\ne_hb=e_hb[2,2,]\t\t\nb_wi = b[[1]][2]\t# slope of wild insects by crop?  lmer calls this the conditional mean\nb_hb = b[[1]][4]\t# slope of hb by crop?  lmer calls this the conditional mean\nmean_wi=(b_wi+a_wi)\t\t\t# mean ...  add by crop part to overall slope\nci_lower_wi=(b_wi+a_wi)-(e_wi*2)\t# lower CI\nci_upper_wi=(b_wi+a_wi)+(e_wi*2)\t# upper CI\nmean_hb=(b_hb+a_hb)\t\t\t# mean ...  add by crop part to overall slope\nci_lower_hb=(b_hb+a_hb)-(e_hb*2)\t# lower CI\nci_upper_hb=(b_hb+a_hb)+(e_hb*2)\t# upper CI\n\n###\nmodelout = cbind(mean_wi, ci_lower_wi, ci_upper_wi, mean_hb, ci_lower_hb, ci_upper_hb)\ncolnames(modelout)[1] = \"mean_wi\"\ncolnames(modelout)[2] = \"ci_lower_wi\"\ncolnames(modelout)[3] = \"ci_upper_wi\"\ncolnames(modelout)[4] = \"mean_hb\"\ncolnames(modelout)[5] = \"ci_lower_hb\"\ncolnames(modelout)[6] = \"ci_upper_hb\"\n\nmodelout$crop = rownames(modelout)\n#modelout\n\nmodelout_mod9 = modelout\n\n# plot figure 2\n#png(filename = \"slopes by crop MODEL 5 10-25-2022.png\", width = 10, height = 5, units = \"in\", bg = \"white\", res = 600)\n\npar(mfrow=c(1,2))\n\nmodelout_mod9 = arrange(modelout_mod9, mean_wi)\nplot(1:nrow(modelout_mod9), modelout_mod9$mean_wi, pch=19, col=\"#00bb5c\", ylim=c(-.75,.75), ylab=\"wild insect slope (mean and 95% CI)\", cex=1.5, xaxt = \"n\", xlab=\"crop study\", main=\"Wild Insects\")\naxis(1, at=seq(0,nrow(modelout_mod9),10), labels=seq(0,nrow(modelout_mod9),10))\narrows(1:nrow(modelout_mod9), modelout_mod9$ci_lower_wi, 1:nrow(modelout_mod9), modelout_mod9$ci_upper_wi, length=0.05, angle=90, code=3, col=\"#00bb5c\", lwd=1.5)\nabline(h=0.060, lty=\"dashed\", lwd=2)\nabline(h=0, lwd=1, col=\"black\", lty=\"dotted\")\n\nmodelout_mod9 = arrange(modelout_mod9, mean_hb)\nplot(1:nrow(modelout_mod9), modelout_mod9$mean_hb, pch=19, col=\"#c96d00\", ylim=c(-.75,.75), ylab=\"honey bee slope (mean and 95% CI)\", cex=1.5, xaxt = \"n\", xlab=\"crop study\", main=\"Honey Bee\")\naxis(1, at=seq(0,nrow(modelout_mod9),10), labels=seq(0,nrow(modelout_mod9),10))\narrows(1:nrow(modelout_mod9), modelout_mod9$ci_lower_hb, 1:nrow(modelout_mod9), modelout_mod9$ci_upper_hb, length=0.05, angle=90, code=3, col=\"#c96d00\", lwd=1.5)\nabline(h=0.070, lty=\"dashed\", lwd=2)\nabline(h=0, lwd=1, col=\"black\", lty=\"dotted\")\n\n#dev.off()\n\n\n```\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":"auto","echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"output-file":"results.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.269","theme":"simplex","title":"Results","editor":"visual","editor_options":{"chunk_output_type":"console"}},"extensions":{"book":{"multiFile":true}}}}}